services:
  primary:
    image: localhost/bind9:latest
    ports:
      - 53:53/udp
      - 53:53/tcp
      - 127.0.0.1:953:953/tcp
    environment:
      OCTODNS_KEY_FILE: /var/run/secrets/octodns.key
      NS_ROLE: primary
      NS_SERVER_COUNT: 1
      NS_1_SERVER: 192.168.131.150
      NS_2_SERVER: 192.168.0.152
      NS_3_SERVER: 192.168.0.153
      AVAILABLE_ZONES: sorakh.local,terra.sorakh.one
    secrets:
      - octodns.key

  secondary-1:
    image: localhost/bind9:latest
    environment:
      OCTODNS_KEY_FILE: /var/run/secrets/octodns.key
      NS_ROLE: secondary
      NS_SERVER_COUNT: 1
      NS_1_SERVER: 192.168.131.150
      NS_2_SERVER: 192.168.0.152
      NS_3_SERVER: 192.168.0.153
      AVAILABLE_ZONES: sorakh.local,terra.sorakh.one
    secrets:
      - octodns.key

  secondary-2:
    image: localhost/bind9:latest
    environment:
      OCTODNS_KEY_FILE: /var/run/secrets/octodns.key
      NS_ROLE: secondary
      NS_SERVER_COUNT: 1
      NS_1_SERVER: 192.168.131.150
      NS_2_SERVER: 192.168.0.152
      NS_3_SERVER: 192.168.0.153
      AVAILABLE_ZONES: sorakh.local,terra.sorakh.one
    secrets:
      - octodns.key

secrets:
  octodns.key:
    file: octodns.key
